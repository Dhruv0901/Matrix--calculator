import math
from itertools import islice
import itertools
import csv


class Functions:
    def __init__(self, main1, main2):
        self.main1 = main1
        self.main2 = main2

    def aesthetics(self):
        a = "\n" * 2
        self.main1.matrix_maker()
        self.m1 = self.main1.eles
        print(a)
        print(5 * a)
        self.main2.matrix_maker()
        self.m2 = self.main2.eles
        print(a)
        self.main_lst = [self.main1.matrix, self.main2.matrix]
        self.main1 = None
        self.main2 = None
        return self.main_lst

    def aesthetics2(self):
        self.scalar = float(input("Enter the value of scalar: "))
        a = "\n" * 2
        self.main1.matrix_maker()
        self.m1 = self.main1.eles
        self.main_lst = self.main1.matrix
        self.main1 = None
        print(a)

    def addition(self, a_list):
        for k in range(len(self.main_lst[0])):
            a_list.append([])
        for i in range(len(self.main_lst[1])):
            for j in range(len(self.main_lst[0][0])):
                a = self.main_lst[0][i][j] + self.main_lst[1][i][j]
                a_list[i].append(a)
                a = 0
        row = len(self.main_lst[0])
        column = len(self.main_lst[0][0])
        print("matrix is -> ")
        for i in range(0, row):
            for j in range(0, column):
                print(a_list[i][j], end="\t")
            print()

    def subtraction(self, a_list):
        for k in range(len(self.main_lst[0])):
            a_list.append([])
        for i in range(len(self.main_lst[1])):
            for j in range(len(self.main_lst[0][0])):
                a = self.main_lst[0][i][j] - self.main_lst[1][i][j]
                a_list[i].append(a)
                a = 0
        row = len(self.main_lst[0])
        column = len(self.main_lst[0][0])
        print("matrix is -> ")
        for i in range(0, row):
            for j in range(0, column):
                print(a_list[i][j], end="\t")
            print()

    def Scalar_multiply(self, scalar, a_list):
        for k in range(len(self.main_lst[0])):
            a_list.append([])
        for i in range(len(self.main_lst[0])):
            for j in range(len(self.main_lst[0])):
                a = self.main_lst[i][j] * scalar
                b = math.ceil(math.modf(a)[0])
                if b == 0:
                    a = int(a)
                else:
                    pass
                a_list[i].append(a)
                a = 0
        row = len(self.main_lst)
        column = len(self.main_lst[0])
        print("matrix is -> ")
        for i in range(0, row):
            for j in range(0, column):
                print(a_list[i][j], end="\t \t")
            print()

    def transpose(self, lst2, main_lst):
        x = 0
        if x != len(lst2):
            for i in range(len(lst2[0])):
                lst = []
                for j in range(len(lst2)):
                    lst.append(lst2[j][x])
                main_lst.append(lst)
                x += 1
            return main_lst

    def Multiplication(self, lst1, lst2, a_lst):
        def lst_multiplication(l1, l2):
            a = 0
            var = 0
            for i in range(len(l1)):
                a += l1[i] * l2[i]
            var = a
            return var

        x = 0
        ele = []
        for k in range(len(self.main_lst[0])):
            for l in range(len(self.main_lst[0])):
                a_lst.append(lst_multiplication(lst1[x], lst2[l]))
            x += 1
        return a_lst

    def output_sorter(self, lst1, lst2, s_lst):
        m = len(lst1)
        n = len(lst2[0])
        lst = []
        for i in range(m):
            lst.append(n)
        Inputt = iter(s_lst)
        Output = [list(islice(Inputt, elem))
                  for elem in lst]
        row = len(Output)
        column = len(Output[0])
        print("matrix is -> ")
        for i in range(0, row):
            for j in range(0, column):
                print(Output[i][j], end="\t")
            print()

    def csv_storer(self, m1, m2, oper, res):
        with open("calc_history.csv", 'a', newline="") as file:
            mywriter = csv.writer(file, delimiter=',')
            d = "        ="
            for i in range(len(m1)):
                mywriter.writerow([m1[i], oper, m2[i], d, res[i]])
            mywriter.writerows([[]])

    def csv_storer_for_scalar_multiply(self, m1, sclr, res):
        with open("calc_history.csv", 'a', newline="") as file:
            mywriter = csv.writer(file, delimiter=',')
            oper = "       *"
            d = "        ="
            for i in range(len(m1)):
                mywriter.writerow([m1[i], oper, sclr, d, res[i]])
            mywriter.writerows([[]])

    def csv_storer_for_multiply(self, m1, m2, res):
        with open("calc_history.csv", 'a', newline="") as file:
            mywriter = csv.writer(file, delimiter=',')
            lst = []
            flag = len(self.main_lst[0])
            ele = []
            ele2 = []
            m_lst = []
            for val in range(flag):
                ele.append(res[0])
                res.remove(res[0])
            m_lst.append(ele)
            for val in range(flag):
                ele2.append(res[0])
                res.remove(res[0])
            m_lst.append(ele2)
            m_lst.append(None)
            d = "        ="
            oper = "       *+"
            a_lst = []
            for (x, y) in itertools.zip_longest(m1, m2):
                a_lst.append([x, y])
            for i in range(len(a_lst)):
                mywriter.writerow([a_lst[i][0], oper, a_lst[i][1], d, m_lst[i]])
            mywriter.writerows([[]])

    def csv_data_show(self):
        with open("calc_history.csv", "r") as main_file:
            main_reader = csv.reader(main_file)
            for i in main_reader:
                print(i)
